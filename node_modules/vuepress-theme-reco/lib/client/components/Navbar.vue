<template>
  <header ref="navbar" class="navbar-container" :style="{ transform: direction == 'top' ? 'translateY(-3.75rem)' : 'translateY(0)'}">
      <!-- <span class="nav-toggle-botton">
        <ToggleSeriesButton @toggle="toggleSeries" />
      </span> -->
      <!-- <SiteBrand /> -->

      <div class="navbar-links-wrapper">
        <!-- <div>
          <NavbarSearch />
        </div> -->
        <NavbarLinks />
        <!-- <ToggleDarkModeButton class="btn--dark-mode" ref="btndarkmode" /> -->
        <!-- <FullScreenButton /> -->
        <!-- <div type="button" class="btn-toggle-menus" ref="btntoggle" @click="toggleMenus">
          <span>
            <span class="vp-top"></span>
            <span class="vp-middle"></span>
            <span class="vp-bottom"></span>
          </span>
        </div> -->
      </div>
  </header>
</template>

<script lang="ts">
import { defineComponent, computed, ref, onMounted } from 'vue'
import { useRouteLocale, useSiteLocaleData, withBase } from '@vuepress/client'
import ToggleDarkModeButton from './ToggleDarkModeButton.vue'
import NavbarLinks from './NavbarLinks.vue'
import ToggleSeriesButton from './ToggleSeriesButton.vue'
import { useSeriesItems, useScrollDirection, useThemeLocaleData } from '../composables'
import Xicons from './global/Xicons.vue'
import SiteBrand from './SiteBrand.vue'
import FullScreenButton from './FullScreenButton.vue'

export default defineComponent({
  components: { NavbarLinks, ToggleSeriesButton, ToggleDarkModeButton, Xicons, SiteBrand, FullScreenButton },
  emits: ['toggle-series', 'toggle-menus'],
  setup(_, ctx) {
    const siteLocale = useSiteLocaleData()
    const routeLocale = useRouteLocale()
    const themeLocal = useThemeLocaleData()
    const seriesItems = useSeriesItems()
    const { direction } = useScrollDirection()

    const siteBrandLink = computed(
      () => themeLocal.value.home || routeLocale.value
    )
    const siteBrandLogo = computed(() => themeLocal.value.logo)
    const siteBrandTitle = computed(() => siteLocale.value.title)

    const navbar = ref<HTMLElement | null>(null)
    const siteBrand = ref<HTMLElement | null>(null)

    const toggleSeries = (): void => {
      ctx.emit('toggle-series')
    }

    const toggleMenus = (): void => {
      ctx.emit('toggle-menus')
    }

    const btntoggle = ref()
    const btndarkmode = ref()
    const navbarWidth = ref(0)

    onMounted(() => {
    //   const btntoggleMenus = btntoggle.value
    //   const handleLinksWrapWidth = (): void => {
    //     const navLink = document.getElementById("navbar-web")
    //     if (!!navLink && !!navLink.offsetWidth) {
    //       navbarWidth.value = navLink.offsetWidth
    //     }
    //     const currentOffetWidth = document.body.offsetWidth
    //     if (!!navbarWidth.value && (currentOffetWidth - navbarWidth.value) <= 400) {
    //       navLink!.style.display = "none"
    //       btntoggleMenus.style.display = "flex"
    //     } else if(!!navbarWidth.value) {
    //       navLink!.style.display = "inline-flex"
    //       btntoggleMenus.style.display = "none"
    //     }
    //   }
    //   handleLinksWrapWidth()
    //   window.addEventListener('resize', handleLinksWrapWidth, false)
    //   window.addEventListener('orientationchange', handleLinksWrapWidth, false)
    })

    return {
      direction,
      seriesItems,
      siteBrandLink,
      siteBrandLogo,
      siteBrandTitle,
      withBase,
      navbar,
      siteBrand,
      btntoggle,
      btndarkmode,
      toggleSeries,
      toggleMenus,
    }
  },
})
</script>
